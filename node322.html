<!DOCTYPE html>

<!--Converted with LaTeX2HTML 99.2beta6 (1.42)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<html>
<head>
<title>Example in MATLAB.</title>
<meta name="description" content="Example in MATLAB.">
<meta name="keywords" content="book">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">

<meta charset="utf-8">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var math_displays = document.getElementsByClassName("math-display");
        for (var i = 0; i < math_displays.length; i++) {
            katex.render(math_displays[i].textContent, math_displays[i], { displayMode: true, throwOnError: false });
        }
        var math_inlines = document.getElementsByClassName("math-inline");
        for (var i = 0; i < math_inlines.length; i++) {
            katex.render(math_inlines[i].textContent, math_inlines[i], { displayMode: false, throwOnError: false });
        }
    });
</script>
<style>
    .navigate {
        background-color: #f0f0f0;
        border: 1px;
        color: black;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 8px;
    }
</style>
<link rel="previous" href="node321.html">
<link rel="up" href="node318.html">
<link rel="next" href="node323.html">
</head>

<body>
<!--Navigation Panel-->
<a name="tex2html5675"
  href="node323.html">
<button class="navigate">下一节</button></a> 
<a name="tex2html5669"
  href="node318.html">
<button class="navigate">上一级</button></a> 
<a name="tex2html5665"
  href="node321.html">
<button class="navigate">上一节</button></a> 
<a name="tex2html5671"
  href="node5.html">
<button class="navigate">目录</button></a> 
<a name="tex2html5673"
  href="node422.html">
<button class="navigate">索引</button></a> 
<br>
<b> Next:</b> <a name="tex2html5676"
  href="node323.html">Notes and References</a>
<b> Up:</b> <a name="tex2html5670"
  href="node318.html">More on GUPTRI and</a>
<b> Previous:</b> <a name="tex2html5666"
  href="node321.html">MATLAB Interface to GUPTRI.</a>
 &nbsp <b>  <a name="tex2html5672"
  href="node5.html">Contents</a></b> 
 &nbsp <b>  <a name="tex2html5674"
  href="node422.html">Index</a></b> 
<br>
<br>
<!--End of Navigation Panel--><h4><a name="SECTION001778040000000000000">
MATLAB 示例</a>
</h4>
让我们考虑以下具有整数项的 <span class="math-inline">5 \times 5</span> 奇异束 <span class="math-inline">A - \lambda B</span>：
<br><p></p>
<div align="center">


<div class="math-display">A = \left[\begin{array}{ccccc}22 &amp; 34 &amp; 31 &amp; 31 &amp; 17 \\...... &amp; 14 &amp; 23 \\24 &amp; 35 &amp; 18 &amp; 21 &amp; 22 \\\end{array}\right].</div>
</div>
<br clear="ALL">
<p></p>
通过构造，此示例的 KCF 为

<span class="math-inline">{\rm diag}( L_0, J_2(0), J_1(2), N_1, L^T_0 )</span>.
我们通过调用计算 <span class="math-inline">A - \lambda B</span> 的 GUPTRI 形式
<br><p></p>
<div align="center">


<div class="math-display">{\tt [S, T, P, Q, kstr] = guptri(A, B)};</div>
</div>
<br clear="ALL">
<p></p>
即，我们使用 EPSU、GAP 和 ZERO 的默认值。 此调用的输出显示如下：

  S =
           0         0  -31.2179   69.7186 -142.6727
           0         0         0   15.8532  -42.1039
           0         0         0  -15.5639   -3.4712
           0         0         0         0   13.5979
           0         0         0         0         0

 T =
           0  -21.5942  -22.1660   44.5153 -110.9818
           0         0  -25.0581   19.3190  -43.8905
           0         0         0   -7.7820    9.2041
           0         0         0         0         0
           0         0         0         0         0

  P =
      0.2697    0.4520    0.8072    0.0226   -0.2660
      0.4045    0.5101   -0.4985    0.5400   -0.1900
      0.6742   -0.3818    0.1705    0.2136    0.5701
      0.1348    0.5620   -0.1771   -0.6188    0.5017
      0.5394   -0.2718   -0.1986   -0.5285   -0.5625

  Q =
     -0.4044    0.1510    0.4636    0.7253   -0.2697
      0.6985   -0.4097    0.1200    0.1975   -0.5394
      0.1470    0.6896   -0.5633    0.1481   -0.4045
     -0.4044   -0.0310    0.1859   -0.5886   -0.6742
     -0.4044   -0.5769   -0.6471    0.2582   -0.1348

  kstr =

       2     1     0    -1     2     0    -1     1    -1
       1     1     0    -1     1     0    -1     1    -1


<p>
kstr 的第一部分（第一个 -1 左侧的所有列）应解释如下：

<ul>
<li> <span class="math-inline">L_{k-1}</span> 块的数量为 
<span class="math-inline">n_k - r_k \equiv{\tt kstr}(1,k+1) - {\tt kstr}(2,k+1)</span>.
</li>
<li> <span class="math-inline">J_k(0)</span> 块的数量为 
<span class="math-inline">r_k - n_{k+1}\equiv {\tt kstr}(2,k) - {\tt kstr}(1,k+1)</span>.
</li>
</ul>

<p>
kstr 的第二部分包含关于 <span class="math-inline">L^T_i</span> 和 <span class="math-inline">N_i</span> 块的相应信息，第三部分包含关于规则部分大小的信息。
对于此示例，我们发现计算的 GUPTRI 形式具有预期的 Kronecker 结构，包括一个 <span class="math-inline">L_0</span> 块
（
<span class="math-inline">{\tt kstr}(1,1) - {\tt kstr}(2,1) = 1</span>），一个
<span class="math-inline">J_2(0)</span> 块（
<span class="math-inline">{\tt kstr}(2,2) - {\tt kstr}(1,3) = 1</span>），
一个 <span class="math-inline">L_0^T</span> 块（
<span class="math-inline">{\tt kstr}(1,5) - {\tt kstr}(2,5) = 1</span>），
一个 <span class="math-inline">N_1</span> 块（
<span class="math-inline">{\tt kstr}(2,5) - {\tt kstr}(1,6) = 1</span>），
最后是一个对应于有限非零特征值 2 的 <span class="math-inline">1 \times 1</span> 规则部分（
<span class="math-inline">{\tt kstr}(1,8) = {\tt kstr}(2,8) = 1</span>）。
<span class="math-inline">L_0</span> 块对应于 <span class="math-inline">A</span> 和 <span class="math-inline">B</span> 具有共同的列零空间（<span class="math-inline">S</span> 和 <span class="math-inline">T</span> 的第一列均为零）。
类似地，<span class="math-inline">L^T_0</span> 块对应于 <span class="math-inline">A</span> 和 <span class="math-inline">B</span> 具有共同的行零空间（<span class="math-inline">S</span> 和 <span class="math-inline">T</span> 的最后一行为零）。
由于 <span class="math-inline">L_0</span> 和 <span class="math-inline">L^T_0</span> 是唯一的奇异块，

<span class="math-inline">A_r - \lambda B_r</span> 的大小为 <span class="math-inline">0 \times 1</span>，

<span class="math-inline">A_l - \lambda B_l</span> 的大小为 <span class="math-inline">1 \times 0</span>。
GUPTRI 形式中剩余的 Kronecker 结构包含在 
<span class="math-inline">S(\mathrm{1:4, 2:5})</span> 和 
<span class="math-inline">T(\mathrm{1:4, 2:5})</span> 中，即 
<span class="math-inline">S</span> 和 <span class="math-inline">T</span> 的第 1 到 4 行和第 2 到 5 列：

<span class="math-inline">A_z - \lambda B_z = S(\mathrm{1:2, 2:3}) - \lambda T(\mathrm{1:2, 2:3})</span>，

<span class="math-inline">A_f - \lambda B_f = S(3,4) - \lambda T(3,4)</span>，
最后是 
<span class="math-inline">A_i - \lambda B_i = S(4,5) - \lambda T(4,5)</span>。

<p>
计算的变换矩阵 <span class="math-inline">P</span> 和 <span class="math-inline">Q</span> 在机器精度范围内是正交的。
此外，
<br><p></p>
<div align="center">


<div class="math-display">\delta = \Vert(A - A', B - B') \Vert _F = 2.8184e-13</div>
</div>
<br clear="ALL">
<p></p>
是到具有 KCF 的 <span class="math-inline">\{A', B'\}</span> 的最近 <span class="math-inline">\{A + \delta A, B + \delta B\}</span> 的距离的上界，其中 
<span class="math-inline">A' = PSQ^{\ast}</span> 和 
<span class="math-inline">B' = PTQ^{\ast}</span>。
对于此示例，<span class="math-inline">\delta</span> 的大小为 

<span class="math-inline">O( {\eps}\Vert(A, B) \Vert _F )</span>，
其中 <span class="math-inline">{\eps}</span> 是机器精度。

<p>
通过设置 
<span class="math-inline">{\tt ZERO} = 0</span> 并进行调用（使用 EPSU 和 GAP 的默认值）
<br><p></p>
<div align="center">


<div class="math-display">{\tt [S, T, P, Q, kstr] = guptri(A, B, EPSU, GAP, ZERO)},</div>
</div>
<br clear="ALL">
<p></p>
我们执行 <span class="math-inline">A - \lambda B</span> 的真实等价变换：

S =

  -2.9227e-15            0   3.1218e+01   6.9719e+01  -1.4267e+02
   2.0749e-15  -3.0175e-15   1.7377e-14   1.5853e+01  -4.2104e+01
  -5.4031e-15  -1.7747e-15   8.8818e-16  -1.5564e+01  -3.4712e+00
   1.6694e-15  -4.4157e-15   2.2204e-15            0   1.3598e+01
  -8.3206e-16   3.1071e-16   1.9984e-15  -2.2204e-16            0

T =

  -6.9809e-31   2.1594e+01   2.2166e+01   4.4515e+01  -1.1098e+02
   3.4328e-31            0   2.5058e+01   1.9319e+01  -4.3890e+01
   1.7764e-15            0            0  -7.7820e+00   9.2041e+00
  -5.5511e-16            0            0            0  -7.5221e-15
            0            0            0            0   3.1465e-15

<span class="math-inline">S</span> 和 <span class="math-inline">T</span> 的下三角部分中的微小非零元素对应于在 GUPTRI 算法的秩确定过程中被解释为数值零的奇异值。
使用 ZERO 的默认值的结果对应于具有计算的 <span class="math-inline">S</span> 和 <span class="math-inline">T</span> 作为其精确 GUPTRI 形式且具有 kstr 中报告的 Kronecker 结构的正则化束。

<p>
我们通过将看似无害的 <span class="math-inline">5 \times 5</span> 示例暴露给 MATLAB 函数 eig 来结束讨论。
调用 [V,D] = eig(A,B) 应该计算一个对角特征值矩阵 <span class="math-inline">D</span> 和一个满矩阵 <span class="math-inline">V</span>，其列是对应的特征向量，使得 <span class="math-inline">A V = B V D</span>。
MATLAB 计算一个对角线项为

        -1.8351e+16  
         2.0000e+00 
         7.2695e-01 - 4.1359e-25i             
        -6.2535e-16 + 2.4399e-08i
        -5.9077e-16 - 2.4399e-08i

的 <span class="math-inline">D</span> 和一个条件数为 

<span class="math-inline">\Vert V \Vert \cdot \Vert V^{-1} \Vert = 8.8817e+08</span> 的特征向量矩阵 <span class="math-inline">V</span>。
大的条件数和残差 
<span class="math-inline">\Vert A V - B V D \Vert = 15.595</span> 表明这不是一个无害的示例，需要进一步调查。
我们得出结论，只有像 guptri 这样的软件工具才能让我们更全面地理解这些病态问题。
它们确实存在于实际应用中！
例如，线性系统理论中的可控性和可观测性问题（参见
[<a
 href="node421.html#vandooren81">447</a>,<a
 href="node421.html#demmelkagstrom88">120</a>]）。

<p>
<hr><!--Navigation Panel-->
<a name="tex2html5675"
  href="node323.html">
<button class="navigate">下一节</button></a> 
<a name="tex2html5669"
  href="node318.html">
<button class="navigate">上一级</button></a> 
<a name="tex2html5665"
  href="node321.html">
<button class="navigate">上一节</button></a> 
<a name="tex2html5671"
  href="node5.html">
<button class="navigate">目录</button></a> 
<a name="tex2html5673"
  href="node422.html">
<button class="navigate">索引</button></a> 
<br>
<b> Next:</b> <a name="tex2html5676"
  href="node323.html">Notes and References</a>
<b> Up:</b> <a name="tex2html5670"
  href="node318.html">More on GUPTRI and</a>
<b> Previous:</b> <a name="tex2html5666"
  href="node321.html">MATLAB Interface to GUPTRI.</a>
 &nbsp <b>  <a name="tex2html5672"
  href="node5.html">Contents</a></b> 
 &nbsp <b>  <a name="tex2html5674"
  href="node422.html">Index</a></b> 
<!--End of Navigation Panel-->
<address>
Susan Blackford
2000-11-20
</address>
</body>
</html>
